<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œì£¼ë„ ì—¬í–‰ ê³„íš íƒ€ì„ë¼ì¸ (ìµœì¢… ë””ë²„ê¹…ìš©)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .timeline-item-container.active .timeline-content {
            transform: scale(1.02);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            border-color: #14B8A6;
        }
        .timeline-content {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #14B8A6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .custom-overlay-content {
            background-color: #14B8A6;
            color: white;
            padding: 4px 8px;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-stone-50 font-sans text-stone-800">

    <div id="app" class="flex flex-col lg:flex-row w-full min-h-screen">
        <aside class="w-full lg:w-1/3 xl:w-1/4 p-6 bg-white shadow-lg overflow-y-auto">
            <header class="mb-6 pb-4 border-b border-stone-200">
                <h1 class="text-3xl font-bold text-stone-900">ì œì£¼ ì—¬í–‰ íƒ€ì„ë¼ì¸</h1>
                <p class="text-stone-500 mt-1">10ì›” 7ì¼ ~ 10ì›” 8ì¼</p>
            </header>
            <nav id="day-selector" class="flex gap-2 mb-6">
                <button data-day="1" class="day-btn flex-1 bg-teal-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-teal-700 transition-all duration-300">Day 1</button>
                <button data-day="2" class="day-btn flex-1 bg-white text-stone-700 font-bold py-3 px-4 rounded-lg shadow-md hover:bg-stone-100 transition-all duration-300">Day 2</button>
            </nav>
            <div id="timeline-container" class="relative"></div>
        </aside>
        <main class="w-full lg:w-2/3 xl:w-3/4 h-[50vh] lg:h-screen">
            <div id="map" class="w-full h-full bg-gray-100 flex items-center justify-center text-center p-4 text-gray-500">
                ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤... <br> ì´ ë©”ì‹œì§€ê°€ ì‚¬ë¼ì§€ì§€ ì•Šìœ¼ë©´ ê°œë°œì ì½˜ì†”(F12)ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
            </div>
        </main>
    </div>
    
    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6 relative">
            <button id="close-modal-btn" class="absolute top-3 right-3 text-stone-400 hover:text-stone-700 text-2xl leading-none">&times;</button>
            <h2 class="text-2xl font-bold text-stone-900 mb-4 flex items-center gap-2">âœ¨ ì£¼ë³€ ì¶”ì²œ ì¥ì†Œ</h2>
            <div id="modal-content" class="text-stone-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>

    <script>
        // --- ì„¤ì • ì˜ì—­ ---
        /* [ì¤‘ìš”] API í‚¤ ì…ë ¥ #1 
          ì•„ë˜ "YOUR_KAKAO_APP_KEY" ë¶€ë¶„ì„ **ë‹¤ì‹œ í•œë²ˆ ì •í™•í•˜ê²Œ** ë³¸ì¸ì˜ ì¹´ì¹´ì˜¤ë§µ Javascript í‚¤ë¡œ êµì²´í•´ì£¼ì„¸ìš”.
          (ê¸°ì¡´ ê°’ì„ ì§€ìš°ê³  ìƒˆë¡œ ë¶™ì—¬ë„£ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.)
        */
        const KAKAO_APP_KEY = 'd3c3d2e4c30d1ef210332f70e5394b36';

        /* [ì¤‘ìš”] API í‚¤ ì…ë ¥ #2
          ì•„ë˜ "YOUR_GEMINI_API_KEY" ë¶€ë¶„ì„ ë³¸ì¸ì˜ Gemini API í‚¤ë¡œ êµì²´í•´ì£¼ì„¸ìš”.
        */
        const GEMINI_API_KEY = 'AIzaSyAHaulmvkZyChIOH1bDVpgtYjijqaiXefA';

        const travelData = {
            1: [
                { time: '10:00', place: 'ì œì£¼êµ­ì œê³µí•­', activity: 'ë„ì°©', lat: 33.510413, lng: 126.491353, icon: 'âœˆï¸' },
                { time: '11:00', place: 'ëª…ë‘ìŠ¤ë‚µ', activity: 'í•œì¹˜ íŠ€ê¹€, ë–¡ë³¶ì´', lat: 33.31301, lng: 126.29949, icon: 'ğŸœ' },
                { time: '12:30', place: 'í’€ë² ê°œ', activity: 'ì»¤í”¼', lat: 33.31688, lng: 126.30252, icon: 'â˜•' },
                { time: '14:00', place: 'ì œì£¼ë¶€ì˜í˜¸í…”&ë¦¬ì¡°íŠ¸', activity: 'ì²´í¬ì¸', lat: 33.2458, lng: 126.4087, icon: 'ğŸ¨' },
                { time: '15:00', place: 'ë²ˆë„¤ì‹ë‹¹', activity: 'ê°ˆì¹˜ì¡°ë¦¼ ì‹ì‚¬', lat: 33.2494, lng: 126.4252, icon: 'ğŸ²' },
                { time: '16:30', place: 'ì œì£¼ë¶€ì˜í˜¸í…”&ë¦¬ì¡°íŠ¸', activity: 'íœ´ì‹', lat: 33.2458, lng: 126.4087, icon: 'ğŸ›Œ' },
                { time: '18:30', place: 'ì¹ ëˆê°€ ì¤‘ë¬¸ì ', activity: 'í‘ë¼ì§€ êµ¬ì´ ì‹ì‚¬', lat: 33.2505, lng: 126.4170, icon: 'ğŸ–' },
                { time: '20:00', place: 'ì œì£¼ë¶€ì˜í˜¸í…”&ë¦¬ì¡°íŠ¸', activity: 'íœ´ì‹', lat: 33.2458, lng: 126.4087, icon: 'ğŸŒ™' }
            ],
            2: [
                { time: '09:00', place: 'ì œì£¼ì„ ì±„í–¥', activity: 'ì „ë³µì¹¼êµ­ìˆ˜ ì‹ì‚¬', lat: 33.2483, lng: 126.4251, icon: 'ğŸœ' },
                { time: '10:30', place: 'ìœ„ì´', activity: 'ì»¤í”¼', lat: 33.2536, lng: 126.4385, icon: 'â˜•' },
                { time: '12:00', place: 'ì˜¤ëŠ”ì • ê¹€ë°¥', activity: 'ê¹€ë°¥ í¬ì¥', lat: 33.2497, lng: 126.5623, icon: 'ğŸ™' },
                { time: '14:00', place: 'ì•„ì¿ ì•„ë·°í‹°í¬', activity: 'ì²´í¬ì¸', lat: 33.5435, lng: 126.6668, icon: 'ğŸ¨' },
                { time: '17:00', place: 'ìˆ™ì„±ë„ í•¨ë•ì ', activity: 'í‘ë¼ì§€ êµ¬ì´ ì‹ì‚¬', lat: 33.5430, lng: 126.6675, icon: 'ğŸ–' },
                { time: '19:00', place: 'ë¯¸ì˜ì´ë„¤ ì¡°ì²œì ', activity: 'ê³ ë“±ì–´ íšŒ í¬ì¥', lat: 33.5450, lng: 126.6974, icon: 'ğŸ£' },
                { time: '20:00', place: 'ì•„ì¿ ì•„ë·°í‹°í¬', activity: 'íœ´ì‹', lat: 33.5435, lng: 126.6668, icon: 'ğŸŒ™' }
            ]
        };

        // --- ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ ---

        let map;
        let markers = [];
        let polyline;
        let currentDay = 1;

        function initMap() {
            const mapContainer = document.getElementById('map');
            const mapOption = { 
                center: new kakao.maps.LatLng(33.361665, 126.520412),
                level: 10
            };
            map = new kakao.maps.Map(mapContainer, mapOption);
            
            setupEventListeners();
            setupModal();
            updateView();
        }

        // --- ë””ë²„ê¹… ê¸°ëŠ¥ì´ ê°•í™”ëœ API ë¡œë” ---
        function loadKakaoMapAPI() {
            if (!KAKAO_APP_KEY || KAKAO_APP_KEY === "YOUR_KAKAO_APP_KEY") {
                document.getElementById('map').innerHTML = 'ì¹´ì¹´ì˜¤ë§µ API í‚¤ê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.<br>ì½”ë“œë¥¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.';
                console.error("ì¹´ì¹´ì˜¤ë§µ API í‚¤ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");
                return;
            }

            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = `//dapi.kakao.com/v2/maps/sdk.js?appkey=${KAKAO_APP_KEY}&libraries=services&autoload=false`;
            script.onload = () => {
                console.log("ì¹´ì¹´ì˜¤ë§µ API ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì„±ê³µ!");
                kakao.maps.load(initMap);
            };
            script.onerror = () => {
                document.getElementById('map').innerHTML = 'ì¹´ì¹´ì˜¤ë§µ API ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>F12ë¥¼ ëˆŒëŸ¬ ê°œë°œì ì½˜ì†”ì˜ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
                console.error("ì¹´ì¹´ì˜¤ë§µ API ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨! API í‚¤, ë„ë©”ì¸ ì„¤ì •, ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.");
            };
            document.head.appendChild(script);
        }
        
        loadKakaoMapAPI(); // ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘

        // ...(ì´í•˜ ë‹¤ë¥¸ í•¨ìˆ˜ë“¤ì€ ì´ì „ê³¼ ë™ì¼)...
        function setupEventListeners(){const daySelector=document.getElementById("day-selector");daySelector.addEventListener("click",e=>{const t=e.target.closest(".day-btn");t&&parseInt(t.dataset.day)!==currentDay&&(currentDay=parseInt(t.dataset.day),updateView(),updateButtonStyles())})}function setupModal(){const e=document.getElementById("gemini-modal"),t=document.getElementById("close-modal-btn");t.addEventListener("click",()=>e.classList.add("hidden")),e.addEventListener("click",t=>{t.target===e&&e.classList.add("hidden")})}async function getGeminiSuggestions(e){if("YOUR_GEMINI_API_KEY"===GEMINI_API_KEY||!GEMINI_API_KEY)return void alert("Gemini API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");const t=document.getElementById("gemini-modal"),n=document.getElementById("modal-content");t.classList.remove("hidden"),n.innerHTML='<div class="loader"></div>';const o=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${GEMINI_API_KEY}`,a=`'${e}, ì œì£¼ë„' ê·¼ì²˜ì˜ í˜„ì§€ì¸ë“¤ì´ ì¢‹ì•„í•  ë§Œí•œ ìˆ¨ê²¨ì§„ ë§›ì§‘, ë…íŠ¹í•œ ì¹´í˜, ë˜ëŠ” ê°€ë³¼ ë§Œí•œ ì¥ì†Œ 3ê³³ì„ ì¶”ì²œí•´ ì¤˜. ê° ì¥ì†Œì— ëŒ€í•œ ì„¤ëª…ì€ í•œë‘ ë¬¸ì¥ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ í•´ì£¼ê³ , ì¶”ì²œ ì´ìœ ë¥¼ ê¼­ í¬í•¨í•´ì¤˜.`;try{const e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}]})});if(!e.ok)throw new Error(`API ìš”ì²­ ì‹¤íŒ¨: ${e.status}`);const t=(await e.json())?.candidates?.[0]?.content?.parts?.[0]?.text;if(t)n.innerHTML=t.replace(/\n/g,"<br>");else throw new Error("Invalid API response structure")}catch(e){console.error("Gemini API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:",e),n.innerHTML='<p class="text-red-500">ì¶”ì²œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ì™€ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</p>'}}function updateButtonStyles(){document.querySelectorAll(".day-btn").forEach(e=>{parseInt(e.dataset.day)===currentDay?(e.classList.remove("bg-white","text-stone-700"),e.classList.add("bg-teal-600","text-white")):(e.classList.remove("bg-teal-600","text-white"),e.classList.add("bg-white","text-stone-700"))})}function clearMap(){markers.forEach(e=>e.overlay.setMap(null)),markers=[],polyline&&polyline.setMap(null)}function createTimelineHTML(e){return`\n                <div class="absolute left-4 top-0 bottom-0 w-0.5 bg-stone-200"></div>\n                ${e.map((e,t)=>`\n                    <div class="timeline-item-container relative mb-4" data-index="${t}">\n                        <div class="timeline-dot absolute left-4 top-6 w-4 h-4 bg-white border-4 border-teal-500 rounded-full" style="transform: translate(-50%, -50%);"></div>\n                        <div class="timeline-content ml-12 p-4 bg-white rounded-lg shadow-md">\n                            <div class="timeline-item cursor-pointer">\n                                <span class="text-sm font-bold text-teal-600">${e.time}</span>\n                                <h3 class="font-semibold text-lg text-stone-800">${t+1}. ${e.place}</h3>\n                                <p class="text-stone-600">${e.icon} ${e.activity}</p>\n                            </div>\n                            <div class="mt-3 pt-3 border-t border-stone-200">\n                                <button class="gemini-suggest-btn w-full text-left text-sm font-semibold text-teal-600 hover:text-teal-800 transition-colors" data-place="${e.place}">ì£¼ë³€ ì¶”ì²œë°›ê¸° âœ¨</button>\n                            </div>\n                        </div>\n                    </div>\n                `).join("")}\n            `}function updateView(){clearMap();const e=travelData[currentDay];document.getElementById("timeline-container").innerHTML=createTimelineHTML(e);const t=new kakao.maps.LatLngBounds,n=[];e.forEach((e,o)=>{const a=new kakao.maps.LatLng(e.lat,e.lng);n.push(a),t.extend(a);const i=document.createElement("div");i.className="custom-overlay-content",i.innerHTML=o+1;const d=new kakao.maps.CustomOverlay({position:a,content:i,yAnchor:1.2});d.setMap(map),i.addEventListener("click",()=>{panTo(a),highlightTimelineItem(o)}),markers.push({overlay:d,position:a,index:o})}),map.setBounds(t),polyline=new kakao.maps.Polyline({path:n,strokeWeight:4,strokeColor:"#0D9488",strokeOpacity:.8,strokeStyle:"solid"}),polyline.setMap(map),addTimelineEventListeners()}function addTimelineEventListeners(){document.getElementById("timeline-container").addEventListener("click",e=>{const t=e.target.closest(".timeline-item");if(t){const n=t.closest(".timeline-item-container"),o=parseInt(n.dataset.index),a=markers.find(e=>e.index===o);a&&(panTo(a.position),highlightTimelineItem(o))}const n=e.target.closest(".gemini-suggest-btn");n&&(e.stopPropagation(),getGeminiSuggestions(n.dataset.place))})}function panTo(e){map.panTo(e)}function highlightTimelineItem(e){document.querySelectorAll(".timeline-item-container").forEach((t,n)=>{n===e?t.classList.contains("active")||(t.classList.add("active"),t.scrollIntoView({behavior:"smooth",block:"center"})):t.classList.remove("active")})}
    </script>
</body>
</html>
